{"version":3,"sources":["Thread.tsx"],"names":["ThreadWithContext","props","additionalMessageInputProps","additionalMessageListProps","autoFocus","closeThread","closeThreadOnDismount","disabled","loadMoreThread","MessageInput","DefaultMessageInput","MessageList","onThreadDismount","thread","loadMoreThreadAsync","id","reply_count","ThreadFooterComponent","editable","Thread","client","reloadThread"],"mappings":"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","sourcesContent":["import React, { useEffect } from 'react';\n\nimport { ThreadFooterComponent } from './components/ThreadFooterComponent';\n\nimport {\n  MessageInput as DefaultMessageInput,\n  MessageInputProps,\n} from '../MessageInput/MessageInput';\nimport { ChatContextValue, useChatContext } from '../../contexts/chatContext/ChatContext';\nimport {\n  MessagesContextValue,\n  useMessagesContext,\n} from '../../contexts/messagesContext/MessagesContext';\nimport { ThreadContextValue, useThreadContext } from '../../contexts/threadContext/ThreadContext';\n\nimport type { MessageListProps } from '../MessageList/MessageList';\n\nimport type {\n  DefaultAttachmentType,\n  DefaultChannelType,\n  DefaultCommandType,\n  DefaultEventType,\n  DefaultMessageType,\n  DefaultReactionType,\n  DefaultUserType,\n  UnknownType,\n} from '../../types/types';\n\ntype ThreadPropsWithContext<\n  At extends UnknownType = DefaultAttachmentType,\n  Ch extends UnknownType = DefaultChannelType,\n  Co extends string = DefaultCommandType,\n  Ev extends UnknownType = DefaultEventType,\n  Me extends UnknownType = DefaultMessageType,\n  Re extends UnknownType = DefaultReactionType,\n  Us extends UnknownType = DefaultUserType,\n> = Pick<ChatContextValue<At, Ch, Co, Ev, Me, Re, Us>, 'client'> &\n  Pick<MessagesContextValue<At, Ch, Co, Ev, Me, Re, Us>, 'MessageList'> &\n  Pick<\n    ThreadContextValue<At, Ch, Co, Ev, Me, Re, Us>,\n    'closeThread' | 'loadMoreThread' | 'reloadThread' | 'thread'\n  > & {\n    /**\n     * Additional props for underlying MessageInput component.\n     * Available props - https://getstream.github.io/stream-chat-react-native/v3/#messageinput\n     * */\n    additionalMessageInputProps?: Partial<MessageInputProps<At, Ch, Co, Ev, Me, Re, Us>>;\n    /**\n     * Additional props for underlying MessageList component.\n     * Available props - https://getstream.github.io/stream-chat-react-native/v3/#messagelist\n     * */\n    additionalMessageListProps?: Partial<MessageListProps<At, Ch, Co, Ev, Me, Re, Us>>;\n    /** Make input focus on mounting thread */\n    autoFocus?: boolean;\n    /** Closes thread on dismount, defaults to true */\n    closeThreadOnDismount?: boolean;\n    /** Disables the thread UI. So MessageInput and MessageList will be disabled. */\n    disabled?: boolean;\n    /**\n     * **Customized MessageInput component to used within Thread instead of default MessageInput\n     * **Available from [MessageInput](https://getstream.github.io/stream-chat-react-native/v3/#messageinput)**\n     */\n    MessageInput?: React.ComponentType<MessageInputProps<At, Ch, Co, Ev, Me, Re, Us>>;\n    /**\n     * Call custom function on closing thread if handling thread state elsewhere\n     */\n    onThreadDismount?: () => void;\n  };\n\nconst ThreadWithContext = <\n  At extends UnknownType = DefaultAttachmentType,\n  Ch extends UnknownType = DefaultChannelType,\n  Co extends string = DefaultCommandType,\n  Ev extends UnknownType = DefaultEventType,\n  Me extends UnknownType = DefaultMessageType,\n  Re extends UnknownType = DefaultReactionType,\n  Us extends UnknownType = DefaultUserType,\n>(\n  props: ThreadPropsWithContext<At, Ch, Co, Ev, Me, Re, Us>,\n) => {\n  const {\n    additionalMessageInputProps,\n    additionalMessageListProps,\n    autoFocus = true,\n    closeThread,\n    closeThreadOnDismount = true,\n    disabled,\n    loadMoreThread,\n    MessageInput = DefaultMessageInput,\n    MessageList,\n    onThreadDismount,\n    thread,\n  } = props;\n\n  useEffect(() => {\n    const loadMoreThreadAsync = async () => {\n      await loadMoreThread();\n    };\n\n    if (thread?.id && thread.reply_count) {\n      loadMoreThreadAsync();\n    }\n  }, []);\n\n  useEffect(\n    () => () => {\n      if (closeThreadOnDismount) {\n        closeThread();\n      }\n      if (onThreadDismount) {\n        onThreadDismount();\n      }\n    },\n    [],\n  );\n\n  if (!thread) return null;\n\n  return (\n    <React.Fragment key={`thread-${thread.id}`}>\n      <MessageList\n        FooterComponent={ThreadFooterComponent}\n        threadList\n        {...additionalMessageListProps}\n      />\n      <MessageInput<At, Ch, Co, Ev, Me, Re, Us>\n        additionalTextInputProps={{ autoFocus, editable: !disabled }}\n        threadList\n        {...additionalMessageInputProps}\n      />\n    </React.Fragment>\n  );\n};\n\nexport type ThreadProps<\n  At extends UnknownType = DefaultAttachmentType,\n  Ch extends UnknownType = DefaultChannelType,\n  Co extends string = DefaultCommandType,\n  Ev extends UnknownType = DefaultEventType,\n  Me extends UnknownType = DefaultMessageType,\n  Re extends UnknownType = DefaultReactionType,\n  Us extends UnknownType = DefaultUserType,\n> = Partial<ThreadPropsWithContext<At, Ch, Co, Ev, Me, Re, Us>>;\n\n/**\n * Thread - The Thread renders a parent message with a list of replies. Use the standard message list of the main channel's messages.\n * The thread is only used for the list of replies to a message.\n *\n * Thread is a consumer of [channel context](https://getstream.github.io/stream-chat-react-native/v3/#channelcontext)\n * Underlying MessageList, MessageInput and Message components can be customized using props:\n * - additionalMessageListProps\n * - additionalMessageInputProps\n */\nexport const Thread = <\n  At extends UnknownType = DefaultAttachmentType,\n  Ch extends UnknownType = DefaultChannelType,\n  Co extends string = DefaultCommandType,\n  Ev extends UnknownType = DefaultEventType,\n  Me extends UnknownType = DefaultMessageType,\n  Re extends UnknownType = DefaultReactionType,\n  Us extends UnknownType = DefaultUserType,\n>(\n  props: ThreadProps<At, Ch, Co, Ev, Me, Re, Us>,\n) => {\n  const { client } = useChatContext<At, Ch, Co, Ev, Me, Re, Us>();\n  const { MessageList } = useMessagesContext<At, Ch, Co, Ev, Me, Re, Us>();\n  const { closeThread, loadMoreThread, reloadThread, thread } =\n    useThreadContext<At, Ch, Co, Ev, Me, Re, Us>();\n\n  return (\n    <ThreadWithContext<At, Ch, Co, Ev, Me, Re, Us>\n      {...{\n        client,\n        closeThread,\n        loadMoreThread,\n        MessageList,\n        reloadThread,\n        thread,\n      }}\n      {...props}\n    />\n  );\n};\n"]}