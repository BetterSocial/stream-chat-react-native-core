{"version":3,"sources":["AttachmentPicker.tsx"],"names":["styles","StyleSheet","create","container","flexGrow","overlay","alignItems","flex","screenHeight","fullScreenHeight","Dimensions","get","height","AttachmentImage","props","ImageOverlaySelectedComponent","numberOfAttachmentPickerImageColumns","onPress","selected","uri","theme","attachmentPicker","image","imageOverlay","colors","size","margin","width","backgroundColor","renderImage","item","asset","maxNumberOfFiles","setSelectedImages","images","filter","length","AttachmentPicker","React","forwardRef","ref","AttachmentPickerBottomSheetHandle","attachmentPickerBottomSheetHandleHeight","attachmentPickerBottomSheetHeight","AttachmentPickerError","attachmentPickerErrorButtonText","AttachmentPickerErrorImage","attachmentPickerErrorText","numberOfAttachmentImagesToLoadPerCall","translucentStatusBar","bottomSheetContentContainer","white","closePicker","selectedImages","selectedPicker","setSelectedPicker","topInset","currentIndex","setCurrentIndex","endCursor","setEndCursor","photoError","setPhotoError","hasNextPage","setHasNextPage","loadingPhotos","setLoadingPhotos","photos","setPhotos","hideAttachmentPicker","undefined","current","close","getMorePhotos","after","first","results","assets","console","log","backAction","backHandler","BackHandler","addEventListener","remove","Platform","OS","Keyboard","addListener","removeListener","selectedPhotos","map","some","handleHeight","statusBarHeight","StatusBar","currentHeight","bottomBarHeight","androidBottomBarHeightAdjustment","snapPoints","index","opacity","displayName"],"mappings":"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","sourcesContent":["import React, { useEffect, useMemo, useState } from 'react';\nimport {\n  BackHandler,\n  Dimensions,\n  ImageBackground,\n  Keyboard,\n  Platform,\n  StatusBar,\n  StyleSheet,\n  View,\n} from 'react-native';\nimport BottomSheet, {\n  BottomSheetFlatList,\n  BottomSheetHandleProps,\n  TouchableOpacity,\n} from '@gorhom/bottom-sheet';\n\nimport { useAttachmentPickerContext } from '../../contexts/attachmentPickerContext/AttachmentPickerContext';\nimport { useTheme } from '../../contexts/themeContext/ThemeContext';\nimport { Asset, getPhotos } from '../../native';\nimport { vh, vw } from '../../utils/utils';\n\nimport type { AttachmentPickerErrorProps } from './components/AttachmentPickerError';\n\nconst styles = StyleSheet.create({\n  container: {\n    flexGrow: 1,\n  },\n  overlay: {\n    alignItems: 'flex-end',\n    flex: 1,\n  },\n});\n\nconst screenHeight = vh(100);\nconst fullScreenHeight = Dimensions.get('screen').height;\n\ntype AttachmentImageProps = {\n  ImageOverlaySelectedComponent: React.ComponentType;\n  onPress: () => void;\n  selected: boolean;\n  uri: string;\n  numberOfAttachmentPickerImageColumns?: number;\n};\n\nconst AttachmentImage: React.FC<AttachmentImageProps> = (props) => {\n  const {\n    ImageOverlaySelectedComponent,\n    numberOfAttachmentPickerImageColumns,\n    onPress,\n    selected,\n    uri,\n  } = props;\n  const {\n    theme: {\n      attachmentPicker: { image, imageOverlay },\n      colors: { overlay },\n    },\n  } = useTheme();\n\n  const size = vw(100) / (numberOfAttachmentPickerImageColumns || 3) - 2;\n\n  return (\n    <TouchableOpacity onPress={onPress}>\n      <ImageBackground\n        source={{ uri }}\n        style={[\n          {\n            height: size,\n            margin: 1,\n            width: size,\n          },\n          image,\n        ]}\n      >\n        {selected && (\n          <View style={[styles.overlay, { backgroundColor: overlay }, imageOverlay]}>\n            <ImageOverlaySelectedComponent />\n          </View>\n        )}\n      </ImageBackground>\n    </TouchableOpacity>\n  );\n};\n\nconst renderImage = ({\n  item,\n}: {\n  item: {\n    asset: Asset;\n    ImageOverlaySelectedComponent: React.ComponentType;\n    maxNumberOfFiles: number;\n    selected: boolean;\n    setSelectedImages: React.Dispatch<React.SetStateAction<Asset[]>>;\n    numberOfAttachmentPickerImageColumns?: number;\n  };\n}) => {\n  const {\n    asset,\n    ImageOverlaySelectedComponent,\n    maxNumberOfFiles,\n    numberOfAttachmentPickerImageColumns,\n    selected,\n    setSelectedImages,\n  } = item;\n  const onPress = () => {\n    if (selected) {\n      setSelectedImages((images) => images.filter((image) => image.uri !== asset.uri));\n    } else {\n      setSelectedImages((images) => {\n        if (images.length >= maxNumberOfFiles) {\n          return images;\n        }\n        return [...images, asset];\n      });\n    }\n  };\n\n  return (\n    <AttachmentImage\n      ImageOverlaySelectedComponent={ImageOverlaySelectedComponent}\n      numberOfAttachmentPickerImageColumns={numberOfAttachmentPickerImageColumns}\n      onPress={onPress}\n      selected={selected}\n      uri={asset.uri}\n    />\n  );\n};\n\nexport type AttachmentPickerProps = {\n  /**\n   * Custom UI component to render [draggable handle](https://github.com/GetStream/stream-chat-react-native/blob/master/screenshots/docs/1.png) of attachment picker.\n   *\n   * **Default** [AttachmentPickerBottomSheetHandle](https://github.com/GetStream/stream-chat-react-native/blob/master/src/components/AttachmentPicker/components/AttachmentPickerBottomSheetHandle.tsx)\n   */\n  AttachmentPickerBottomSheetHandle: React.FC<BottomSheetHandleProps>;\n  /**\n   * Custom UI component to render error component while opening attachment picker.\n   *\n   * **Default** [AttachmentPickerError](https://github.com/GetStream/stream-chat-react-native/blob/master/src/components/AttachmentPicker/components/AttachmentPickerError.tsx)\n   */\n  AttachmentPickerError: React.ComponentType<AttachmentPickerErrorProps>;\n  /**\n   * Custom UI component to render error image for attachment picker\n   *\n   * **Default** [AttachmentPickerErrorImage](https://github.com/GetStream/stream-chat-react-native/blob/master/src/components/AttachmentPicker/components/AttachmentPickerErrorImage.tsx)\n   */\n  AttachmentPickerErrorImage: React.ComponentType;\n  /**\n   * Custom UI component to render overlay component, that shows up on top of [selected image](https://github.com/GetStream/stream-chat-react-native/blob/master/screenshots/docs/1.png) (with tick mark)\n   *\n   * **Default** [ImageOverlaySelectedComponent](https://github.com/GetStream/stream-chat-react-native/blob/master/src/components/AttachmentPicker/components/ImageOverlaySelectedComponent.tsx)\n   */\n  ImageOverlaySelectedComponent: React.ComponentType;\n  attachmentPickerBottomSheetHandleHeight?: number;\n  attachmentPickerBottomSheetHeight?: number;\n  attachmentPickerErrorButtonText?: string;\n  attachmentPickerErrorText?: string;\n  numberOfAttachmentImagesToLoadPerCall?: number;\n  numberOfAttachmentPickerImageColumns?: number;\n  translucentStatusBar?: boolean;\n};\n\nexport const AttachmentPicker = React.forwardRef(\n  (props: AttachmentPickerProps, ref: React.ForwardedRef<BottomSheet>) => {\n    const {\n      AttachmentPickerBottomSheetHandle,\n      attachmentPickerBottomSheetHandleHeight,\n      attachmentPickerBottomSheetHeight,\n      AttachmentPickerError,\n      attachmentPickerErrorButtonText,\n      AttachmentPickerErrorImage,\n      attachmentPickerErrorText,\n      ImageOverlaySelectedComponent,\n      numberOfAttachmentImagesToLoadPerCall,\n      numberOfAttachmentPickerImageColumns,\n      translucentStatusBar,\n    } = props;\n\n    const {\n      theme: {\n        attachmentPicker: { bottomSheetContentContainer },\n        colors: { white },\n      },\n    } = useTheme();\n    const {\n      closePicker,\n      maxNumberOfFiles,\n      selectedImages,\n      selectedPicker,\n      setSelectedImages,\n      setSelectedPicker,\n      topInset,\n    } = useAttachmentPickerContext();\n\n    const [currentIndex, setCurrentIndex] = useState(-1);\n    const [endCursor, setEndCursor] = useState<string>();\n    const [photoError, setPhotoError] = useState(false);\n    const [hasNextPage, setHasNextPage] = useState(true);\n    const [loadingPhotos, setLoadingPhotos] = useState(false);\n    const [photos, setPhotos] = useState<Asset[]>([]);\n\n    const hideAttachmentPicker = () => {\n      setSelectedPicker(undefined);\n      if ((ref as React.MutableRefObject<BottomSheet>)?.current) {\n        (ref as React.MutableRefObject<BottomSheet>).current.close();\n      }\n    };\n\n    const getMorePhotos = async () => {\n      if (hasNextPage && !loadingPhotos && currentIndex > -1 && selectedPicker === 'images') {\n        setLoadingPhotos(true);\n        try {\n          const results = await getPhotos({\n            after: endCursor,\n            first: numberOfAttachmentImagesToLoadPerCall ?? 60,\n          });\n          if (endCursor) {\n            setPhotos([...photos, ...results.assets]);\n          } else {\n            setPhotos(results.assets);\n          }\n          setEndCursor(results.endCursor);\n          setHasNextPage(results.hasNextPage || false);\n        } catch (error) {\n          console.log(error);\n          setPhotoError(true);\n        }\n        setLoadingPhotos(false);\n      }\n    };\n\n    useEffect(() => {\n      const backAction = () => {\n        if (selectedPicker) {\n          setSelectedPicker(undefined);\n          closePicker();\n          return true;\n        }\n\n        return false;\n      };\n\n      const backHandler = BackHandler.addEventListener('hardwareBackPress', backAction);\n\n      return () => backHandler.remove();\n    }, [selectedPicker]);\n\n    useEffect(() => {\n      if (Platform.OS === 'ios') {\n        Keyboard.addListener('keyboardWillShow', hideAttachmentPicker);\n      } else {\n        Keyboard.addListener('keyboardDidShow', hideAttachmentPicker);\n      }\n\n      return () => {\n        if (Platform.OS === 'ios') {\n          Keyboard.removeListener('keyboardWillShow', hideAttachmentPicker);\n        } else {\n          Keyboard.removeListener('keyboardDidShow', hideAttachmentPicker);\n        }\n      };\n    }, []);\n\n    useEffect(() => {\n      if (currentIndex < 0) {\n        setSelectedPicker(undefined);\n        if (!loadingPhotos) {\n          setEndCursor(undefined);\n          setHasNextPage(true);\n        }\n      }\n    }, [currentIndex]);\n\n    useEffect(() => {\n      if (\n        selectedPicker === 'images' &&\n        endCursor === undefined &&\n        currentIndex > -1 &&\n        !loadingPhotos\n      ) {\n        setPhotoError(false);\n        getMorePhotos();\n      }\n    }, [currentIndex, selectedPicker]);\n\n    const selectedPhotos = photos.map((asset) => ({\n      asset,\n      ImageOverlaySelectedComponent,\n      maxNumberOfFiles,\n      numberOfAttachmentPickerImageColumns,\n      selected: selectedImages.some((image) => image.uri === asset.uri),\n      setSelectedImages,\n    }));\n\n    const handleHeight = attachmentPickerBottomSheetHandleHeight || 20;\n\n    /**\n     * This is to handle issues with Android measurements coming back incorrect.\n     * If the StatusBar height is perfectly 1/2 of the difference between the two\n     * dimensions for screen and window, it is incorrect and we need to account for\n     * this. If you use a translucent header bar more adjustments are needed.\n     */\n    const statusBarHeight = StatusBar.currentHeight ?? 0;\n    const bottomBarHeight = fullScreenHeight - screenHeight - statusBarHeight;\n    const androidBottomBarHeightAdjustment =\n      Platform.OS === 'android'\n        ? bottomBarHeight === statusBarHeight\n          ? translucentStatusBar\n            ? 0\n            : StatusBar.currentHeight ?? 0\n          : translucentStatusBar\n          ? bottomBarHeight > statusBarHeight\n            ? -bottomBarHeight + statusBarHeight\n            : bottomBarHeight > 0\n            ? -statusBarHeight\n            : 0\n          : bottomBarHeight > 0\n          ? 0\n          : statusBarHeight\n        : 0;\n\n    /**\n     * Snap points changing cause a rerender of the position,\n     * this is an issue if you are calling close on the bottom sheet.\n     */\n    const snapPoints = useMemo(\n      () => [\n        attachmentPickerBottomSheetHeight ??\n          308 + (fullScreenHeight - screenHeight + androidBottomBarHeightAdjustment) - handleHeight,\n        fullScreenHeight - topInset - handleHeight,\n      ],\n      [\n        androidBottomBarHeightAdjustment,\n        attachmentPickerBottomSheetHeight,\n        fullScreenHeight,\n        handleHeight,\n        screenHeight,\n        topInset,\n      ],\n    );\n\n    return (\n      <>\n        <BottomSheet\n          containerHeight={fullScreenHeight}\n          handleComponent={\n            /**\n             * using `null` here instead of `style={{ opacity: photoError ? 0 : 1 }}`\n             * as opacity is not an allowed style\n             */\n            photoError ? null : AttachmentPickerBottomSheetHandle\n          }\n          handleHeight={handleHeight}\n          index={-1}\n          onChange={(index: number) => setCurrentIndex(index)}\n          ref={ref}\n          snapPoints={snapPoints}\n        >\n          <BottomSheetFlatList\n            contentContainerStyle={[\n              styles.container,\n              { backgroundColor: white },\n              bottomSheetContentContainer,\n              { opacity: photoError ? 0 : 1 },\n            ]}\n            data={selectedPhotos}\n            keyExtractor={(item) => item.asset.uri}\n            numColumns={numberOfAttachmentPickerImageColumns ?? 3}\n            onEndReached={getMorePhotos}\n            renderItem={renderImage}\n          />\n        </BottomSheet>\n        {selectedPicker === 'images' && photoError && (\n          <AttachmentPickerError\n            attachmentPickerBottomSheetHeight={attachmentPickerBottomSheetHeight}\n            attachmentPickerErrorButtonText={attachmentPickerErrorButtonText}\n            AttachmentPickerErrorImage={AttachmentPickerErrorImage}\n            attachmentPickerErrorText={attachmentPickerErrorText}\n          />\n        )}\n      </>\n    );\n  },\n);\n\nAttachmentPicker.displayName = 'AttachmentPicker';\n"]}